<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Post::Meterpreter::Packet
  
    &mdash; Documentation by YARD 0.9.7
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Rex::Post::Meterpreter::Packet";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span>
     &raquo; 
    <span class="title">Packet</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Post::Meterpreter::Packet
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="GroupTlv.html" title="Rex::Post::Meterpreter::GroupTlv (class)">GroupTlv</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Tlv.html" title="Rex::Post::Meterpreter::Tlv (class)">Tlv</a></span></li>
          
            <li class="next"><span class='object_link'><a href="GroupTlv.html" title="Rex::Post::Meterpreter::GroupTlv (class)">GroupTlv</a></span></li>
          
            <li class="next">Rex::Post::Meterpreter::Packet</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/post/meterpreter/packet.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The logical meterpreter packet class</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at-instance_method" title="#created_at (instance method)">#<strong>created_at</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute created_at.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="GroupTlv.html" title="Rex::Post::Meterpreter::GroupTlv (class)">GroupTlv</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="GroupTlv.html#tlvs-instance_method" title="Rex::Post::Meterpreter::GroupTlv#tlvs (method)">#tlvs</a></span></p>

  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Tlv.html" title="Rex::Post::Meterpreter::Tlv (class)">Tlv</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Tlv.html#compress-instance_method" title="Rex::Post::Meterpreter::Tlv#compress (method)">#compress</a></span>, <span class='object_link'><a href="Tlv.html#type-instance_method" title="Rex::Post::Meterpreter::Tlv#type (method)">#type</a></span>, <span class='object_link'><a href="Tlv.html#value-instance_method" title="Rex::Post::Meterpreter::Tlv#value (method)">#value</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_request-class_method" title="create_request (class method)">.<strong>create_request</strong>(method = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a request with the supplied method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_response-class_method" title="create_response (class method)">.<strong>create_response</strong>(request = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a response to a request if one is provided.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_r-instance_method" title="#from_r (instance method)">#<strong>from_r</strong>(bytes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Override the function that reads from a raw byte stream so that the XORing
of data is included in the process prior to passing it on to the default
functionality that can parse the TLV values.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(type = nil, method = nil)  &#x21d2; Packet </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes the packet to the supplied packet type and method, if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#method-instance_method" title="#method (instance method)">#<strong>method</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of the packet&#39;s method TLV.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#method=-instance_method" title="#method= (instance method)">#<strong>method=</strong>(method)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the packet&#39;s method TLV to the method supplied.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#method%3F-instance_method" title="#method? (instance method)">#<strong>method?</strong>(method)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the packet&#39;s method is equal to the supplied method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#response%3F-instance_method" title="#response? (instance method)">#<strong>response?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the packet is a response.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result-instance_method" title="#result (instance method)">#<strong>result</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the value of the packet&#39;s result TLV.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result=-instance_method" title="#result= (instance method)">#<strong>result=</strong>(result)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the packet&#39;s result TLV.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result%3F-instance_method" title="#result? (instance method)">#<strong>result?</strong>(result)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the packet&#39;s result value is equal to the supplied
result.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rid-instance_method" title="#rid (instance method)">#<strong>rid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the value of the packet&#39;s request identifier TLV.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_r-instance_method" title="#to_r (instance method)">#<strong>to_r</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Override the function that creates the raw byte stream for sending so that
it generates an XOR key, uses it to scramble the serialized TLV content,
and then returns the key plus the scrambled data as the payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#xor_bytes-instance_method" title="#xor_bytes (instance method)">#<strong>xor_bytes</strong>(xor_key, bytes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Xor a set of bytes with a given DWORD xor key.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="GroupTlv.html" title="Rex::Post::Meterpreter::GroupTlv (class)">GroupTlv</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="GroupTlv.html#add_tlv-instance_method" title="Rex::Post::Meterpreter::GroupTlv#add_tlv (method)">#add_tlv</a></span>, <span class='object_link'><a href="GroupTlv.html#add_tlvs-instance_method" title="Rex::Post::Meterpreter::GroupTlv#add_tlvs (method)">#add_tlvs</a></span>, <span class='object_link'><a href="GroupTlv.html#each-instance_method" title="Rex::Post::Meterpreter::GroupTlv#each (method)">#each</a></span>, <span class='object_link'><a href="GroupTlv.html#each_tlv-instance_method" title="Rex::Post::Meterpreter::GroupTlv#each_tlv (method)">#each_tlv</a></span>, <span class='object_link'><a href="GroupTlv.html#each_tlv_with_index-instance_method" title="Rex::Post::Meterpreter::GroupTlv#each_tlv_with_index (method)">#each_tlv_with_index</a></span>, <span class='object_link'><a href="GroupTlv.html#each_with_index-instance_method" title="Rex::Post::Meterpreter::GroupTlv#each_with_index (method)">#each_with_index</a></span>, <span class='object_link'><a href="GroupTlv.html#get_tlv-instance_method" title="Rex::Post::Meterpreter::GroupTlv#get_tlv (method)">#get_tlv</a></span>, <span class='object_link'><a href="GroupTlv.html#get_tlv_value-instance_method" title="Rex::Post::Meterpreter::GroupTlv#get_tlv_value (method)">#get_tlv_value</a></span>, <span class='object_link'><a href="GroupTlv.html#get_tlv_values-instance_method" title="Rex::Post::Meterpreter::GroupTlv#get_tlv_values (method)">#get_tlv_values</a></span>, <span class='object_link'><a href="GroupTlv.html#get_tlvs-instance_method" title="Rex::Post::Meterpreter::GroupTlv#get_tlvs (method)">#get_tlvs</a></span>, <span class='object_link'><a href="GroupTlv.html#has_tlv%3F-instance_method" title="Rex::Post::Meterpreter::GroupTlv#has_tlv? (method)">#has_tlv?</a></span>, <span class='object_link'><a href="GroupTlv.html#reset-instance_method" title="Rex::Post::Meterpreter::GroupTlv#reset (method)">#reset</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Tlv.html" title="Rex::Post::Meterpreter::Tlv (class)">Tlv</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Tlv.html#htonq-instance_method" title="Rex::Post::Meterpreter::Tlv#htonq (method)">#htonq</a></span>, <span class='object_link'><a href="Tlv.html#inspect-instance_method" title="Rex::Post::Meterpreter::Tlv#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="Tlv.html#meta_type%3F-instance_method" title="Rex::Post::Meterpreter::Tlv#meta_type? (method)">#meta_type?</a></span>, <span class='object_link'><a href="Tlv.html#ntohq-instance_method" title="Rex::Post::Meterpreter::Tlv#ntohq (method)">#ntohq</a></span>, <span class='object_link'><a href="Tlv.html#type%3F-instance_method" title="Rex::Post::Meterpreter::Tlv#type? (method)">#type?</a></span>, <span class='object_link'><a href="Tlv.html#value%3F-instance_method" title="Rex::Post::Meterpreter::Tlv#value? (method)">#value?</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(type = nil, method = nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes the packet to the supplied packet type and method, if any.  If
the packet is a request, a request identifier is created.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 650</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_method'>method</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>

  <span class='comment'># If it&#39;s a request, generate a random request identifier
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_REQUEST-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_REQUEST (constant)">PACKET_TYPE_REQUEST</a></span></span><span class='rparen'>)</span> <span class='op'>||</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_PLAIN_REQUEST-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_PLAIN_REQUEST (constant)">PACKET_TYPE_PLAIN_REQUEST</a></span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rid'>rid</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

    <span class='int'>32</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span> <span class='id identifier rubyid_rid'>rid</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_REQUEST_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_REQUEST_ID (constant)">TLV_TYPE_REQUEST_ID</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_rid'>rid</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="created_at=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="created_at-instance_method">
  
    #<strong>created_at</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute created_at</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


606
607
608</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 606</span>

<span class='kw'>def</span> <span class='id identifier rubyid_created_at'>created_at</span>
  <span class='ivar'>@created_at</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_request-class_method">
  
    .<strong>create_request</strong>(method = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a request with the supplied method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


617
618
619</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 617</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create_request'>create_request</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Rex::Post::Meterpreter::Packet#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_REQUEST-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_REQUEST (constant)">PACKET_TYPE_REQUEST</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_response-class_method">
  
    .<strong>create_response</strong>(request = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a response to a request if one is provided.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


624
625
626
627
628
629
630
631
632
633
634
635
636
637</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 624</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create_response'>create_response</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response_type'>response_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_RESPONSE-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_RESPONSE (constant)">PACKET_TYPE_RESPONSE</a></span></span>
  <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_type?'>type?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_PLAIN_REQUEST-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_PLAIN_REQUEST (constant)">PACKET_TYPE_PLAIN_REQUEST</a></span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_response_type'>response_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_PLAIN_RESPONSE-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_PLAIN_RESPONSE (constant)">PACKET_TYPE_PLAIN_RESPONSE</a></span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_method'>method</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Rex::Post::Meterpreter::Packet#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response_type'>response_type</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="from_r-instance_method">
  
    #<strong>from_r</strong>(bytes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Override the function that reads from a raw byte stream so that the XORing
of data is included in the process prior to passing it on to the default
functionality that can parse the TLV values.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


692
693
694
695</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 692</span>

<span class='kw'>def</span> <span class='id identifier rubyid_from_r'>from_r</span><span class='lparen'>(</span><span class='id identifier rubyid_bytes'>bytes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_xor_key'>xor_key</span> <span class='op'>=</span> <span class='id identifier rubyid_bytes'>bytes</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_xor_bytes'>xor_bytes</span><span class='lparen'>(</span><span class='id identifier rubyid_xor_key'>xor_key</span><span class='comma'>,</span> <span class='id identifier rubyid_bytes'>bytes</span><span class='lbracket'>[</span><span class='int'>4</span><span class='comma'>,</span> <span class='id identifier rubyid_bytes'>bytes</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="method-instance_method">
  
    #<strong>method</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of the packet&#39;s method TLV.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


745
746
747</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 745</span>

<span class='kw'>def</span> <span class='id identifier rubyid_method'>method</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_METHOD-constant" title="Rex::Post::Meterpreter::TLV_TYPE_METHOD (constant)">TLV_TYPE_METHOD</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="method=-instance_method">
  
    #<strong>method=</strong>(method)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the packet&#39;s method TLV to the method supplied.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


738
739
740</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 738</span>

<span class='kw'>def</span> <span class='id identifier rubyid_method='>method=</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_METHOD-constant" title="Rex::Post::Meterpreter::TLV_TYPE_METHOD (constant)">TLV_TYPE_METHOD</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="method?-instance_method">
  
    #<strong>method?</strong>(method)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the packet&#39;s method is equal to the supplied method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


731
732
733</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 731</span>

<span class='kw'>def</span> <span class='id identifier rubyid_method?'>method?</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_METHOD-constant" title="Rex::Post::Meterpreter::TLV_TYPE_METHOD (constant)">TLV_TYPE_METHOD</a></span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="response?-instance_method">
  
    #<strong>response?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the packet is a response.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


717
718
719
720</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 717</span>

<span class='kw'>def</span> <span class='id identifier rubyid_response?'>response?</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_RESPONSE-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_RESPONSE (constant)">PACKET_TYPE_RESPONSE</a></span></span><span class='rparen'>)</span> <span class='op'>||</span>
          <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_PLAIN_RESPONSE-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_PLAIN_RESPONSE (constant)">PACKET_TYPE_PLAIN_RESPONSE</a></span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result-instance_method">
  
    #<strong>result</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the value of the packet&#39;s result TLV.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


767
768
769</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 767</span>

<span class='kw'>def</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_RESULT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_RESULT (constant)">TLV_TYPE_RESULT</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result=-instance_method">
  
    #<strong>result=</strong>(result)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the packet&#39;s result TLV.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


760
761
762</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 760</span>

<span class='kw'>def</span> <span class='id identifier rubyid_result='>result=</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_RESULT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_RESULT (constant)">TLV_TYPE_RESULT</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result?-instance_method">
  
    #<strong>result?</strong>(result)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the packet&#39;s result value is equal to the supplied
result.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


753
754
755</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 753</span>

<span class='kw'>def</span> <span class='id identifier rubyid_result?'>result?</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_RESULT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_RESULT (constant)">TLV_TYPE_RESULT</a></span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rid-instance_method">
  
    #<strong>rid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the value of the packet&#39;s request identifier TLV.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


774
775
776</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 774</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rid'>rid</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_REQUEST_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_REQUEST_ID (constant)">TLV_TYPE_REQUEST_ID</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_r-instance_method">
  
    #<strong>to_r</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Override the function that creates the raw byte stream for sending so that
it generates an XOR key, uses it to scramble the serialized TLV content,
and then returns the key plus the scrambled data as the payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


676
677
678
679
680
681
682
683
684</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 676</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_r'>to_r</span>
  <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='kw'>super</span>
  <span class='id identifier rubyid_xor_key'>xor_key</span> <span class='op'>=</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>254</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='id identifier rubyid_xor_key'>xor_key</span> <span class='op'>|=</span> <span class='lparen'>(</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>254</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='int'>8</span>
  <span class='id identifier rubyid_xor_key'>xor_key</span> <span class='op'>|=</span> <span class='lparen'>(</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>254</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='int'>16</span>
  <span class='id identifier rubyid_xor_key'>xor_key</span> <span class='op'>|=</span> <span class='lparen'>(</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>254</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='int'>24</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_xor_key'>xor_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_xor_bytes'>xor_bytes</span><span class='lparen'>(</span><span class='id identifier rubyid_xor_key'>xor_key</span><span class='comma'>,</span> <span class='id identifier rubyid_raw'>raw</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="xor_bytes-instance_method">
  
    #<strong>xor_bytes</strong>(xor_key, bytes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Xor a set of bytes with a given DWORD xor key.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


700
701
702
703
704
705
706</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 700</span>

<span class='kw'>def</span> <span class='id identifier rubyid_xor_bytes'>xor_bytes</span><span class='lparen'>(</span><span class='id identifier rubyid_xor_key'>xor_key</span><span class='comma'>,</span> <span class='id identifier rubyid_bytes'>bytes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_bytes'>bytes</span><span class='period'>.</span><span class='id identifier rubyid_bytes'>bytes</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_xor_key'>xor_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_bytes'>bytes</span><span class='period'>.</span><span class='id identifier rubyid_cycle'>cycle</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ord'>ord</span> <span class='op'>^</span> <span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ord'>ord</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_chr'>chr</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan 17 22:43:22 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.7 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>