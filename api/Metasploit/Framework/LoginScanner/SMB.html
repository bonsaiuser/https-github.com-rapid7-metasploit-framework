<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Metasploit::Framework::LoginScanner::SMB
  
    &mdash; Documentation by YARD 0.9.7
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Metasploit::Framework::LoginScanner::SMB";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Framework.html" title="Metasploit::Framework (module)">Framework</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../LoginScanner.html" title="Metasploit::Framework::LoginScanner (module)">LoginScanner</a></span></span>
     &raquo; 
    <span class="title">SMB</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Metasploit::Framework::LoginScanner::SMB
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Metasploit::Framework::LoginScanner::SMB</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Base.html" title="Metasploit::Framework::LoginScanner::Base (module)">Base</a></span>, <span class='object_link'><a href="NTLM.html" title="Metasploit::Framework::LoginScanner::NTLM (module)">NTLM</a></span>, <span class='object_link'><a href="RexSocket.html" title="Metasploit::Framework::LoginScanner::RexSocket (module)">RexSocket</a></span>, <span class='object_link'><a href="../Tcp/Client.html" title="Metasploit::Framework::Tcp::Client (module)">Tcp::Client</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/metasploit/framework/login_scanner/smb.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This is the LoginScanner class for dealing with the Server Messaging Block
protocol.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="SMB/AccessLevels.html" title="Metasploit::Framework::LoginScanner::SMB::AccessLevels (module)">AccessLevels</a></span>, <span class='object_link'><a href="SMB/StatusCodes.html" title="Metasploit::Framework::LoginScanner::SMB::StatusCodes (module)">StatusCodes</a></span>
    
  
    
  
</p>

  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="CAN_GET_SESSION-constant" class="">CAN_GET_SESSION =
        
      </dt>
      <dd><pre class="code"><span class='kw'>true</span></pre></dd>
    
      <dt id="DEFAULT_REALM-constant" class="">DEFAULT_REALM =
        
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WORKSTATION</span><span class='tstring_end'>&#39;</span></span></pre></dd>
    
      <dt id="LIKELY_PORTS-constant" class="">LIKELY_PORTS =
        
      </dt>
      <dd><pre class="code"><span class='lbracket'>[</span> <span class='int'>139</span><span class='comma'>,</span> <span class='int'>445</span> <span class='rbracket'>]</span></pre></dd>
    
      <dt id="LIKELY_SERVICE_NAMES-constant" class="">LIKELY_SERVICE_NAMES =
        
      </dt>
      <dd><pre class="code"><span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>smb</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span></pre></dd>
    
      <dt id="PRIVATE_TYPES-constant" class="">PRIVATE_TYPES =
        
      </dt>
      <dd><pre class="code"><span class='lbracket'>[</span> <span class='symbol'>:password</span><span class='comma'>,</span> <span class='symbol'>:ntlm_hash</span> <span class='rbracket'>]</span></pre></dd>
    
      <dt id="REALM_KEY-constant" class="">REALM_KEY =
        
      </dt>
      <dd><pre class="code"><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Realm</span><span class='op'>::</span><span class='const'>Key</span><span class='op'>::</span><span class='const'>ACTIVE_DIRECTORY_DOMAIN</span></pre></dd>
    
  </dl>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#simple-instance_method" title="#simple (instance method)">#<strong>simple</strong>  &#x21d2; Rex::Proto::SMB::SimpleClient </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_chunk_size-instance_method" title="#smb_chunk_size (instance method)">#<strong>smb_chunk_size</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_chunk_size.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_direct-instance_method" title="#smb_direct (instance method)">#<strong>smb_direct</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_direct.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_name-instance_method" title="#smb_name (instance method)">#<strong>smb_name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_native_lm-instance_method" title="#smb_native_lm (instance method)">#<strong>smb_native_lm</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_native_lm.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_native_os-instance_method" title="#smb_native_os (instance method)">#<strong>smb_native_os</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_native_os.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_obscure_trans_pipe_level-instance_method" title="#smb_obscure_trans_pipe_level (instance method)">#<strong>smb_obscure_trans_pipe_level</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_obscure_trans_pipe_level.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_pad_data_level-instance_method" title="#smb_pad_data_level (instance method)">#<strong>smb_pad_data_level</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_pad_data_level.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_pad_file_level-instance_method" title="#smb_pad_file_level (instance method)">#<strong>smb_pad_file_level</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_pad_file_level.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_pipe_evasion-instance_method" title="#smb_pipe_evasion (instance method)">#<strong>smb_pipe_evasion</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute smb_pipe_evasion.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_verify_signature-instance_method" title="#smb_verify_signature (instance method)">#<strong>smb_verify_signature</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>UNUSED attr_accessor :smb_pipe_read_max_size attr_accessor
:smb_pipe_read_min_size attr_accessor :smb_pipe_write_max_size
attr_accessor :smb_pipe_write_min_size.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Tcp/Client.html" title="Metasploit::Framework::Tcp::Client (module)">Tcp::Client</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Tcp/Client.html#max_send_size-instance_method" title="Metasploit::Framework::Tcp::Client#max_send_size (method)">#max_send_size</a></span>, <span class='object_link'><a href="../Tcp/Client.html#send_delay-instance_method" title="Metasploit::Framework::Tcp::Client#send_delay (method)">#send_delay</a></span>, <span class='object_link'><a href="../Tcp/Client.html#sock-instance_method" title="Metasploit::Framework::Tcp::Client#sock (method)">#sock</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attempt_bogus_login-instance_method" title="#attempt_bogus_login (instance method)">#<strong>attempt_bogus_login</strong>(domain)  &#x21d2; Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If login is successul and <span class='object_link'><a href="Result.html#access_level-instance_method" title="Metasploit::Framework::LoginScanner::Result#access_level (method)">Result#access_level</a></span> is not set then arbitrary
credentials are accepted.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attempt_login-instance_method" title="#attempt_login (instance method)">#<strong>attempt_login</strong>(credential)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_sane_defaults-instance_method" title="#set_sane_defaults (instance method)">#<strong>set_sane_defaults</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Tcp/Client.html" title="Metasploit::Framework::Tcp::Client (module)">Tcp::Client</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Tcp/Client.html#chost-instance_method" title="Metasploit::Framework::Tcp::Client#chost (method)">#chost</a></span>, <span class='object_link'><a href="../Tcp/Client.html#cport-instance_method" title="Metasploit::Framework::Tcp::Client#cport (method)">#cport</a></span>, <span class='object_link'><a href="../Tcp/Client.html#disconnect-instance_method" title="Metasploit::Framework::Tcp::Client#disconnect (method)">#disconnect</a></span>, <span class='object_link'><a href="../Tcp/Client.html#proxies-instance_method" title="Metasploit::Framework::Tcp::Client#proxies (method)">#proxies</a></span>, <span class='object_link'><a href="../Tcp/Client.html#rhost-instance_method" title="Metasploit::Framework::Tcp::Client#rhost (method)">#rhost</a></span>, <span class='object_link'><a href="../Tcp/Client.html#rport-instance_method" title="Metasploit::Framework::Tcp::Client#rport (method)">#rport</a></span>, <span class='object_link'><a href="../Tcp/Client.html#set_tcp_evasions-instance_method" title="Metasploit::Framework::Tcp::Client#set_tcp_evasions (method)">#set_tcp_evasions</a></span>, <span class='object_link'><a href="../Tcp/Client.html#ssl-instance_method" title="Metasploit::Framework::Tcp::Client#ssl (method)">#ssl</a></span>, <span class='object_link'><a href="../Tcp/Client.html#ssl_version-instance_method" title="Metasploit::Framework::Tcp::Client#ssl_version (method)">#ssl_version</a></span></p>

  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="simple=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="simple-instance_method">
  
    #<strong>simple</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../Rex/Proto/SMB/SimpleClient.html" title="Rex::Proto::SMB::SimpleClient (class)">Rex::Proto::SMB::SimpleClient</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Rex/Proto/SMB/SimpleClient.html" title="Rex::Proto::SMB::SimpleClient (class)">Rex::Proto::SMB::SimpleClient</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_simple'>simple</span>
  <span class='ivar'>@simple</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_chunk_size=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_chunk_size-instance_method">
  
    #<strong>smb_chunk_size</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_chunk_size</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 58</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_chunk_size'>smb_chunk_size</span>
  <span class='ivar'>@smb_chunk_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_direct=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_direct-instance_method">
  
    #<strong>smb_direct</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_direct</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_direct'>smb_direct</span>
  <span class='ivar'>@smb_direct</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_name-instance_method">
  
    #<strong>smb_name</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_name'>smb_name</span>
  <span class='ivar'>@smb_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_native_lm=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_native_lm-instance_method">
  
    #<strong>smb_native_lm</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_native_lm</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 60</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_native_lm'>smb_native_lm</span>
  <span class='ivar'>@smb_native_lm</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_native_os=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_native_os-instance_method">
  
    #<strong>smb_native_os</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_native_os</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 61</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_native_os'>smb_native_os</span>
  <span class='ivar'>@smb_native_os</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_obscure_trans_pipe_level=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_obscure_trans_pipe_level-instance_method">
  
    #<strong>smb_obscure_trans_pipe_level</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_obscure_trans_pipe_level</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_obscure_trans_pipe_level'>smb_obscure_trans_pipe_level</span>
  <span class='ivar'>@smb_obscure_trans_pipe_level</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_pad_data_level=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_pad_data_level-instance_method">
  
    #<strong>smb_pad_data_level</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_pad_data_level</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_pad_data_level'>smb_pad_data_level</span>
  <span class='ivar'>@smb_pad_data_level</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_pad_file_level=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_pad_file_level-instance_method">
  
    #<strong>smb_pad_file_level</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_pad_file_level</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_pad_file_level'>smb_pad_file_level</span>
  <span class='ivar'>@smb_pad_file_level</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_pipe_evasion=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_pipe_evasion-instance_method">
  
    #<strong>smb_pipe_evasion</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute smb_pipe_evasion</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_pipe_evasion'>smb_pipe_evasion</span>
  <span class='ivar'>@smb_pipe_evasion</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="smb_verify_signature=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="smb_verify_signature-instance_method">
  
    #<strong>smb_verify_signature</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>UNUSED attr_accessor :smb_pipe_read_max_size attr_accessor
:smb_pipe_read_min_size attr_accessor :smb_pipe_write_max_size
attr_accessor :smb_pipe_write_min_size</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_verify_signature'>smb_verify_signature</span>
  <span class='ivar'>@smb_verify_signature</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="attempt_bogus_login-instance_method">
  
    #<strong>attempt_bogus_login</strong>(domain)  &#x21d2; <tt><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If login is successul and <span class='object_link'><a href="Result.html#access_level-instance_method" title="Metasploit::Framework::LoginScanner::Result#access_level (method)">Result#access_level</a></span> is not set then arbitrary
credentials are accepted. If it is set to Guest, then arbitrary credentials
are accepted, but given Guest permissions.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>domain</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Domain to authenticate against. Use an empty string for local accounts.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attempt_bogus_login'>attempt_bogus_login</span><span class='lparen'>(</span><span class='id identifier rubyid_domain'>domain</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@result_for_bogus</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@result_for_bogus</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cred'>cred</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Credential.html" title="Metasploit::Framework::Credential (class)">Credential</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Credential.html#initialize-instance_method" title="Metasploit::Framework::Credential#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>public:</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>8</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>private:</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>8</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>realm:</span> <span class='id identifier rubyid_domain'>domain</span>
  <span class='rparen'>)</span>
  <span class='ivar'>@result_for_bogus</span> <span class='op'>=</span> <span class='id identifier rubyid_attempt_login'>attempt_login</span><span class='lparen'>(</span><span class='id identifier rubyid_cred'>cred</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="attempt_login-instance_method">
  
    #<strong>attempt_login</strong>(credential)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attempt_login'>attempt_login</span><span class='lparen'>(</span><span class='id identifier rubyid_credential'>credential</span><span class='rparen'>)</span>

  <span class='comment'># Disable direct SMB when SMBDirect has not been set and the
</span>  <span class='comment'># destination port is configured as 139
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_direct'>smb_direct</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_direct'>smb_direct</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span>
                      <span class='kw'>when</span> <span class='int'>139</span> <span class='kw'>then</span> <span class='kw'>false</span>
                      <span class='kw'>when</span> <span class='int'>445</span> <span class='kw'>then</span> <span class='kw'>true</span>
                      <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_connect'>connect</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/ConnectionError.html" title="Rex::ConnectionError (class)">ConnectionError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span>
      <span class='label'>credential:</span><span class='id identifier rubyid_credential'>credential</span><span class='comma'>,</span>
      <span class='label'>status:</span> <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>UNABLE_TO_CONNECT</span><span class='comma'>,</span>
      <span class='label'>proof:</span> <span class='id identifier rubyid_e'>e</span><span class='comma'>,</span>
      <span class='label'>host:</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span>
      <span class='label'>port:</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span>
      <span class='label'>protocol:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='label'>service_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>smb</span><span class='tstring_end'>&#39;</span></span>
    <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_proof'>proof</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>begin</span>
    <span class='comment'># TODO: OMG
</span>    <span class='id identifier rubyid_simple'>simple</span><span class='period'>.</span><span class='id identifier rubyid_login'>login</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_smb_name'>smb_name</span><span class='comma'>,</span>
      <span class='id identifier rubyid_credential'>credential</span><span class='period'>.</span><span class='id identifier rubyid_public'>public</span><span class='comma'>,</span>
      <span class='id identifier rubyid_credential'>credential</span><span class='period'>.</span><span class='id identifier rubyid_private'>private</span><span class='comma'>,</span>
      <span class='id identifier rubyid_credential'>credential</span><span class='period'>.</span><span class='id identifier rubyid_realm'>realm</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='id identifier rubyid_smb_verify_signature'>smb_verify_signature</span><span class='comma'>,</span>
      <span class='id identifier rubyid_use_ntlmv2'>use_ntlmv2</span><span class='comma'>,</span>
      <span class='id identifier rubyid_use_ntlm2_session'>use_ntlm2_session</span><span class='comma'>,</span>
      <span class='id identifier rubyid_send_lm'>send_lm</span><span class='comma'>,</span>
      <span class='id identifier rubyid_use_lmkey'>use_lmkey</span><span class='comma'>,</span>
      <span class='id identifier rubyid_send_ntlm'>send_ntlm</span><span class='comma'>,</span>
      <span class='id identifier rubyid_smb_native_os'>smb_native_os</span><span class='comma'>,</span>
      <span class='id identifier rubyid_smb_native_lm'>smb_native_lm</span><span class='comma'>,</span>
      <span class='lbrace'>{</span>
        <span class='label'>use_spn:</span> <span class='id identifier rubyid_send_spn'>send_spn</span><span class='comma'>,</span>
        <span class='label'>name:</span> <span class='id identifier rubyid_host'>host</span>
      <span class='rbrace'>}</span>
    <span class='rparen'>)</span>

    <span class='comment'># Windows SMB will return an error code during Session
</span>    <span class='comment'># Setup, but nix Samba requires a Tree Connect. Try admin$
</span>    <span class='comment'># first, since that will tell us if this user has local
</span>    <span class='comment'># admin access. Fall back to IPC$ which should be accessible
</span>    <span class='comment'># to any user with valid creds.
</span>    <span class='kw'>begin</span>
      <span class='id identifier rubyid_simple'>simple</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\admin$</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_access_level'>access_level</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="SMB/AccessLevels.html" title="Metasploit::Framework::LoginScanner::SMB::AccessLevels (module)">AccessLevels</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SMB/AccessLevels.html#ADMINISTRATOR-constant" title="Metasploit::Framework::LoginScanner::SMB::AccessLevels::ADMINISTRATOR (constant)">ADMINISTRATOR</a></span></span>
      <span class='id identifier rubyid_simple'>simple</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\admin$</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions.html" title="Rex::Proto::SMB::Exceptions (module)">Exceptions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions/ErrorCode.html" title="Rex::Proto::SMB::Exceptions::ErrorCode (class)">ErrorCode</a></span></span>
      <span class='id identifier rubyid_simple'>simple</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\IPC$</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># If we made it this far without raising, we have a valid
</span>    <span class='comment'># login
</span>    <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>SUCCESSFUL</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions.html" title="Rex::Proto::SMB::Exceptions (module)">Exceptions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions/LoginError.html" title="Rex::Proto::SMB::Exceptions::LoginError (class)">LoginError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_get_error'>get_error</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_error_code'>error_code</span><span class='rparen'>)</span>
             <span class='kw'>when</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="SMB/StatusCodes.html" title="Metasploit::Framework::LoginScanner::SMB::StatusCodes (module)">StatusCodes</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SMB/StatusCodes.html#CORRECT_CREDENTIAL_STATUS_CODES-constant" title="Metasploit::Framework::LoginScanner::SMB::StatusCodes::CORRECT_CREDENTIAL_STATUS_CODES (constant)">CORRECT_CREDENTIAL_STATUS_CODES</a></span></span>
               <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>DENIED_ACCESS</span>
             <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STATUS_ACCOUNT_LOCKED_OUT</span><span class='tstring_end'>&#39;</span></span>
               <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>LOCKED_OUT</span>
             <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STATUS_LOGON_FAILURE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STATUS_ACCESS_DENIED</span><span class='tstring_end'>&#39;</span></span>
               <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>INCORRECT</span>
             <span class='kw'>else</span>
               <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>INCORRECT</span>
             <span class='kw'>end</span>

    <span class='id identifier rubyid_proof'>proof</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions.html" title="Rex::Proto::SMB::Exceptions (module)">Exceptions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/Exceptions/Error.html" title="Rex::Proto::SMB::Exceptions::Error (class)">Error</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>INCORRECT</span>
    <span class='id identifier rubyid_proof'>proof</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/ConnectionError.html" title="Rex::ConnectionError (class)">ConnectionError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>UNABLE_TO_CONNECT</span>
    <span class='id identifier rubyid_proof'>proof</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>SUCCESSFUL</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_simple'>simple</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_auth_user'>auth_user</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_access_level'>access_level</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="SMB/AccessLevels.html" title="Metasploit::Framework::LoginScanner::SMB::AccessLevels (module)">AccessLevels</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SMB/AccessLevels.html#GUEST-constant" title="Metasploit::Framework::LoginScanner::SMB::AccessLevels::GUEST (constant)">GUEST</a></span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>credential:</span> <span class='id identifier rubyid_credential'>credential</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='id identifier rubyid_proof'>proof</span><span class='comma'>,</span> <span class='label'>access_level:</span> <span class='id identifier rubyid_access_level'>access_level</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span>         <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span>         <span class='op'>=</span> <span class='id identifier rubyid_port'>port</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_service_name'>service_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>smb</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connect-instance_method">
  
    #<strong>connect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237
238
239
240
241
242
243
244
245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 235</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span>
  <span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='kw'>super</span>

  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex/Proto/SMB/SimpleClient.html" title="Rex::Proto::SMB::SimpleClient (class)">SimpleClient</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../../Rex/Proto/SMB/SimpleClient.html#initialize-instance_method" title="Rex::Proto::SMB::SimpleClient#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sock'>sock</span><span class='comma'>,</span> <span class='id identifier rubyid_smb_direct'>smb_direct</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_evasion_opts'>evasion_opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pad_data</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_smb_pad_data_level'>smb_pad_data_level</span>
  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_evasion_opts'>evasion_opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pad_file</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_smb_pad_file_level'>smb_pad_file_level</span>
  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_evasion_opts'>evasion_opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>obscure_trans_pipe</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_smb_obscure_trans_pipe_level'>smb_obscure_trans_pipe_level</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_simple'>simple</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_sane_defaults-instance_method">
  
    #<strong>set_sane_defaults</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/smb.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_sane_defaults'>set_sane_defaults</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_connection_timeout'>connection_timeout</span>           <span class='op'>=</span> <span class='int'>10</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_connection_timeout'>connection_timeout</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_max_send_size'>max_send_size</span>                <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_max_send_size'>max_send_size</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_delay'>send_delay</span>                   <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_delay'>send_delay</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_lm'>send_lm</span>                      <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_lm'>send_lm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_ntlm'>send_ntlm</span>                    <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_ntlm'>send_ntlm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_spn'>send_spn</span>                     <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_spn'>send_spn</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_chunk_size'>smb_chunk_size</span>               <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_chunk_size'>smb_chunk_size</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_name'>smb_name</span>                     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*SMBSERVER</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_name'>smb_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_native_lm'>smb_native_lm</span>                <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Windows 2000 5.0</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_native_os'>smb_native_os</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_native_os'>smb_native_os</span>                <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Windows 2000 2195</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_native_os'>smb_native_os</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_obscure_trans_pipe_level'>smb_obscure_trans_pipe_level</span> <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_obscure_trans_pipe_level'>smb_obscure_trans_pipe_level</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pad_data_level'>smb_pad_data_level</span>           <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pad_data_level'>smb_pad_data_level</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pad_file_level'>smb_pad_file_level</span>           <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pad_file_level'>smb_pad_file_level</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pipe_evasion'>smb_pipe_evasion</span>             <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_pipe_evasion'>smb_pipe_evasion</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='comment'>#self.smb_pipe_read_max_size       = 1024 if self.smb_pipe_read_max_size.nil?
</span>  <span class='comment'>#self.smb_pipe_read_min_size       = 0 if self.smb_pipe_read_min_size.nil?
</span>  <span class='comment'>#self.smb_pipe_write_max_size      = 1024 if self.smb_pipe_write_max_size.nil?
</span>  <span class='comment'>#self.smb_pipe_write_min_size      = 0 if self.smb_pipe_write_min_size.nil?
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_verify_signature'>smb_verify_signature</span>         <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_verify_signature'>smb_verify_signature</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_lmkey'>use_lmkey</span>              <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_lmkey'>use_lmkey</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_ntlm2_session'>use_ntlm2_session</span>            <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_ntlm2_session'>use_ntlm2_session</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_ntlmv2'>use_ntlmv2</span>                   <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_use_ntlmv2'>use_ntlmv2</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_name'>smb_name</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_smb_name'>smb_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan 17 22:41:30 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.7 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>